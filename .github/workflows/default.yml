name: Dotfiles Management - Foundation Testing
on:
  push:
    branches:
      - main
  # Allow manual triggering for testing
  workflow_dispatch:
jobs:
  foundation-validation:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          ref: main
        # install Stow dependency and run foundational checks
      - name: Install GNU Stow
        run: sudo apt-get update && sudo apt-get install -y stow
      # Assumes a Makefile preinstalled
      - name: Foundational Checks
        run: |
          make check-tools
          make check-root
        - name: Verify deployment would succeed (dry-run conflict check)
          run: make verify

